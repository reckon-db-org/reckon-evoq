{erl_opts, [
    debug_info,
    warn_export_vars,
    warn_unused_vars,
    warn_unused_import
]}.

{deps, [
    %% evoq for adapter behavior definitions
    {evoq, "~> 1.2"},

    %% Gateway API for reckon-db operations
    %% Provides shared types (event, snapshot, subscription records)
    {reckon_gater, "~> 1.1.2"},

    %% Telemetry for observability
    {telemetry, "~> 1.3"}
]}.

%% For local development, use _checkouts with symlinks:
%%   mkdir -p _checkouts
%%   ln -s /path/to/evoq _checkouts/evoq
%%   ln -s /path/to/reckon-gater _checkouts/reckon_gater

{profiles, [
    {test, [
        {deps, [
            {meck, "0.9.2"}
        ]}
    ]}
]}.

{plugins, [
    rebar3_hex,
    rebar3_ex_doc
]}.

{cover_enabled, true}.
{cover_opts, [verbose]}.

{dialyzer, [
    {warnings, [
        unmatched_returns,
        error_handling,
        underspecs
    ]},
    {plt_apps, top_level_deps}
]}.

%% Ex_doc configuration
{ex_doc, [
    {extras, [
        {"README.md", #{title => <<"Readme">>}},
        {"CHANGELOG.md", #{title => <<"Changelog">>}}
    ]},
    {main, <<"README.md">>},
    {assets, <<"assets">>},
    {source_url, <<"https://github.com/reckon-db-org/reckon-evoq">>}
]}.

%% Hex configuration
{hex, [
    {doc, #{provider => ex_doc}}
]}.

%% Package metadata for hex.pm
{pkg, [
    {name, reckon_evoq},
    {description, "Adapter for connecting evoq CQRS/ES framework to reckon-db event store via reckon-gater gateway."},
    {licenses, ["Apache-2.0"]},
    {links, [
        {"GitHub", "https://github.com/reckon-db-org/reckon-evoq"},
        {"evoq", "https://github.com/reckon-db-org/evoq"},
        {"reckon-db", "https://github.com/reckon-db-org/reckon-db"},
        {"reckon-gater", "https://github.com/reckon-db-org/reckon-gater"}
    ]},
    {files, [
        "src",
        "assets",
        "rebar.config",
        "README.md",
        "CHANGELOG.md"
    ]},
    {maintainers, ["Reckon-DB"]},
    {build_tools, ["rebar3"]}
]}.
